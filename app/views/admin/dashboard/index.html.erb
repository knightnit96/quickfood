<% provide :title, t(".title") %>
<div class="content-wrapper">
  <div class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1 class="m-0 text-dark">Trang điều khiển</h1>
        </div>
        <div class="col-sm-6">
          <ol class="breadcrumb float-sm-right">
            <li class="breadcrumb-item active">Trang điều khiển</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <section class="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 col-sm-6 col-md-3">
          <div class="info-box">
            <span class="info-box-icon bg-info elevation-1"><i class="fas fa-motorcycle"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Tổng số người giao hàng</span>
              <span class="info-box-number">
                <span class="info-box-number"><%= @total_shippers %></span>
              </span>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="info-box mb-3">
            <span class="info-box-icon bg-danger elevation-1"><i class="fas fa-store"></i></span>

            <div class="info-box-content">
              <span class="info-box-text">Tổng số địa điểm</span>
              <span class="info-box-number"><%= @total_places %></span>
            </div>
          </div>
        </div>
        <div class="clearfix hidden-md-up"></div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="info-box mb-3">
            <span class="info-box-icon bg-success elevation-1"><i class="fas fa-users"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Tổng số người dùng đã đăng ký</span>
              <span class="info-box-number"><%= @total_users %></span>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="info-box mb-3">
            <span class="info-box-icon bg-warning elevation-1"><i class="fas fa-star"></i></span>

            <div class="info-box-content">
              <span class="info-box-text">Tổng số đánh giá</span>
              <span class="info-box-number"><%= @total_ratings %></span>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Địa điểm cần xác nhận mới nhất</h3>
              <div class="card-tools">
                <span class="badge badge-danger"><%= @places.count %> địa điểm cần xác nhận</span>
                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                </button>
              </div>
            </div>
            <div class="card-body p-0">
              <ul class="users-list clearfix">
                <% if @places.present? %>
                  <% @places[0..7].each do |place| %>
                    <li>
                      <img src="/assets/img/quants.jpg" alt="" width="200px">
                      <a href data-toggle="modal" data-target="#modal_detal_place_<%= place.id %>"><%= place.name %></a>
                      <span class="users-list-date">
                        <a data-title="<%= t("javascript.are_you_sure_confirm") %>" href="#" rel="nofollow" class="select_is_proposal" data-id="<%= place.id %>" data-value="0">
                          <span class="fas fa-check"></span>
                        </a>
                        &nbsp;&nbsp;&nbsp;
                        <a data-title="<%= t("javascript.are_you_sure_cancel") %>" href="#" rel="nofollow" class="select_is_proposal" data-id="<%= place.id %>" data-value="1">
                          <span class="fas fa-times"></span>
                        </a>
                      </span>
                    </li>
                  <% end %>
                <% end %>
              </ul>
            </div>
            <div class="card-footer text-center">
              <%= link_to "Xem tất cả các địa điểm", admin_places_path %>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Người giao hàng mới nhất</h3>
              <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
                </button>
              </div>
            </div>
            <div class="card-body p-0" style="display: block;">
              <ul class="products-list product-list-in-card pl-2 pr-2">
                <% if @shippers.present? %>
                  <% @shippers[0..7].each do |shipper| %>
                    <li class="item">
                      <div class="product-img">
                        <%= image_tag shipper.user_avatar.url, class: "img-size-50" %>
                      </div>
                      <div class="product-info">
                        <a href data-toggle="modal" data-target="#modal_detal_shipper_<%= shipper.id %>"><%= shipper.user_name %></a>
                        <span class="badge badge-warning float-right"><%= shipper.province_name %></span></a>
                        <span class="product-description">
                        Giới tính:
                        <% if shipper.user_gender == 1 %>
                          <strong>Nam</strong>
                        <% elsif shipper.user_gender == 2 %>
                          <strong>Nữ</strong>
                        <% end %>
                        </span>
                      </div>
                    </li>
                  <% end %>
                <% end %>
              </ul>
            </div>
            <div class="card-footer text-center" style="display: block;">
              <%= link_to "Xem tất cả người giao hàng", admin_shippers_path, class: "uppercase" %>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Cài đặt nhanh</h3>
              <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
                </button>
                </button>
              </div>
            </div>
            <div class="card-body p-0">
              <ul class="products-list product-list-in-card pl-2 pr-2">
                <li class="item">
                  <div class="product-img">
                    <i class="fas fa-list"></i>
                  </div>
                  <div class="product-info">
                    <%= link_to "Thêm danh mục", new_admin_category_path, class: "product-title" %>
                  </div>
                </li>
                <li class="item">
                  <div class="product-img">
                    <i class="fas fa-users"></i>
                  </div>
                  <div class="product-info">
                    <%= link_to "Thêm người dùng", new_admin_user_path, class: "product-title" %>
                  </div>
                </li>
                <li class="item">
                  <div class="product-img">
                    <i class="fas fa-th"></i>
                  </div>
                  <div class="product-info">
                    <%= link_to "Thêm phân mục", new_admin_classify_category_path, class: "product-title" %>
                  </div>
                </li>
                <li class="item">
                  <div class="product-img">
                    <i class="fas fa-store"></i>
                  </div>
                  <div class="product-info">
                    <%= link_to "Xác nhận địa điểm", admin_places_path, class: "product-title" %>
                  </div>
                </li>
                <li class="item">
                  <div class="product-img">
                    <i class="fas fa-edit"></i>
                  </div>
                  <div class="product-info">
                    <%= link_to "Chỉnh sửa thông tin cá nhân", edit_admin_user_path(current_user), class: "product-title" %>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
<% @places.each do |place| %>
  <div class="modal fade" id="modal_detal_place_<%= place.id %>">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"><%= t ".detail_place" %></h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row">
              <div class="col-lg-8">
                <div class="details_item">
                  <h4><%= place.name %></h4>
                  <ul class="list">
                    <li><span><%= t ".owner" %></span> : <a href data-toggle="modal" data-target="#modal_detal_user_place_<%= place.id %>"><%= place.user_name %></a></li>
                    <li><span><%= t ".address" %></span> : <%= place.address %></li>
                    <li><span><%= t ".category" %></span> : <%= place.category_name %></li>
                    <li><span><%= t ".province" %></span> : <%= place.province_name %>, <%= Province.find_by(id: place.province_parent_id).name %></li>
                    <li><span><%= t ".phone" %></span> : <%= place.phone %></li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="details_item">
                  <%= image_tag place.user_avatar.url, class: "img-fluid" %>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-12">
                <div class="details_item">
                  <ul class="list">
                    <li><span><%= t ".detail_direction" %></span> : <%= place.detail_direction %></li>
                    <li><span><%= t ".email" %></span> : <%= place.email %></li>
                    <li><span><%= t ".website" %></span> : <a href="<%= place.website %>"><%= place.website %></a></li>
                    <li><span><%= t ".description" %></span> : <%= place.description %></li>
                    <li><span><%= t ".capacity" %></span> : <%= place.capacity %></li>
                    <li><span><%= t ".start_time" %></span> : <%= place.start_time %></li>
                    <li><span><%= t ".close_time" %></span> : <%= place.close_time %></li>
                    <li><span><%= t ".average_price" %></span> : <%= number_to_currency_format place.average_price %></li>
                    <li><span><%= t ".rating" %></span> : <%= place.rating %> <i class="fas fa-star" style="color: yellow;"></i></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="modal_detal_user_place_<%= place.id %>">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"><%= t ".detail_user" %></h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row">
              <div class="col-lg-8">
                <div class="details_item">
                  <h4><%= place.user_name %></h4>
                  <ul class="list">
                    <li><span><%= t ".email" %></span> : <%= place.user_email %></li>
                    <% if place.user_gender == 1 %>
                      <li><span><%= t ".gender" %></span> : male</li>
                    <% elsif place.user_gender == 2 %>
                      <li><span><%= t ".gender" %></span> : female</li>
                    <% end %>
                    <li><span><%= t ".role" %></span> : <%= place.user_role %></li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="details_item">
                  <%= image_tag place.user_avatar.url, class: "img-fluid" %>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-12">
                <%= t ".address" %>
                <ul class="list">
                  <% list_address(place.user_id).each do |address| %>
                    <li><%= address.address %>
                      <ul class="list">
                        <li><span><%= t ".common_name" %></span> : <%= address.common_name %></li>
                        <li><span><%= t ".name" %></span> : <%= address.name %></li>
                        <li><span><%= t ".phone" %></span> : <%= address.phone %></li>
                      </ul>
                    </li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>
<% @shippers.each do |shipper| %>
  <div class="modal fade" id="modal_detal_shipper_<%= shipper.id %>">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"><%= t ".detail_shipper" %></h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row">
              <div class="col-lg-8">
                <div class="details_item">
                  <h4><a href data-toggle="modal" data-target="#modal_detal_user_shipper_<%= shipper.id %>"><%= shipper.user_name %></a>
                  </h4>
                  <ul class="list">
                    <li><span><%= t ".email" %></span> : <%= shipper.user_email %></li>
                    <% if shipper.user_gender == 1 %>
                      <li><span><%= t ".gender" %></span> : male</li>
                    <% elsif shipper.user_gender == 2 %>
                      <li><span><%= t ".gender" %></span> : female</li>
                    <% end %>
                    <li><span><%= t ".province" %></span> : <%= shipper.province_name %></li>
                    <li><span><%= t ".identity_card" %></span> : <%= shipper.identity_card %></li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="details_item">
                  <%= image_tag shipper.user_avatar.url, class: "img-fluid" %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="modal_detal_user_shipper_<%= shipper.id %>">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"><%= t ".detail_user" %></h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row">
              <div class="col-lg-8">
                <div class="details_item">
                  <h4><%= shipper.user_name %></h4>
                  <ul class="list">
                    <li><span><%= t ".email" %></span> : <%= shipper.user_email %></li>
                    <% if shipper.user_gender == 1 %>
                      <li><span><%= t ".gender" %></span> : male</li>
                    <% elsif shipper.user_gender == 2 %>
                      <li><span><%= t ".gender" %></span> : female</li>
                    <% end %>
                    <li><span><%= t ".role" %></span> : <%= shipper.user_role %></li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-4">
                <div class="details_item">
                  <%= image_tag shipper.user_avatar.url, class: "img-fluid" %>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-12">
                <%= t ".address" %>
                <ul class="list">
                  <% list_address(shipper.user_id).each do |address| %>
                    <li><%= address.address %>
                      <ul class="list">
                        <li><span><%= t ".common_name" %></span> : <%= address.common_name %></li>
                        <li><span><%= t ".name" %></span> : <%= address.name %></li>
                        <li><span><%= t ".phone" %></span> : <%= address.phone %></li>
                      </ul>
                    </li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<%= javascript_include_tag "admin/custom_admin" %>
